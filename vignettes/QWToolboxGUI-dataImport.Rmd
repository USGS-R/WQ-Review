---
title: "WQReview GUI - importing data"
author: "T. Joe Mills"
date: "`r Sys.Date()`"
output:
  html_vignette:
    toc: false

vignette: >
  %\VignetteIndexEntry{WQReview GUI- importing data}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

This will describe the process for importing data into the WQReview GUI. We will start by importing data for a 
single site using predefined NWIS parameter groups. At the end we will see how to import data for multiple sites
and custom parameter lists.

## Load the WQReview package and open the WQReview GUI

1. Load the WQReview package by typing the following into your R script or command window:

```R
library(WQReview)
```

1. You must specify your server name and the environmental and QA database numbers for your data when you start the WQReview GUI. For most environmental data the database number is "01" and for most QA data it is "02". These are the default values in WQReview and if these are the database numbers for your data you do not need to change them. To open the GUI run the WQReview() function with the database arguments for your data. For example at the CO WSC you would type the following into your R script or command window.

```R
WQReview(dlserver.name = "NWISCO", env.db.num = "01", qa.db.num = "02")
```

The GUI window will open with the server and database information stored and you may now work entirely from this window.

## Importing data

The data import tab has 5 main panes:

1. Site Selection: This pane selects the method of site ID input using a radio button. You can manually type in a single site ID, you can pick from a favorites list imported when you started WQReview, or you can read IDs in directly from a csv file.
    
1. pCode selection: This pane selects the method of pCode input using a radio button. You can select from NWIS parameter groups, you can pick from a favorites list imported when you started WQReview, or you can read pCodes in directly from a csv file.

1. Favorite site list: A list of siteIDs will appear here if you started WQReview by reading in a list of favorite sites using the "siteids" argument. You can import data for one or multiple of your favorites by clicking them to highlight. You can select multiple sites from the list using ctrl-click or shift-click. 

1. Favorite pcode list: A list of pcodes will appear here if you started WQReview by reading in a list of favorite pcodes using the "pcodes" argument. You can import data for one or multiple of your favorites by clicking them to highlight. You can select multiple sites from the list using ctrl-click or shift-click. 

1. Date range. You may specify a date range to import data for in yyyy-mm-dd format. If the range is left unchanged it will pull the entire period of record.

#A basic data import
We will start with a basic data import for a single site by parameter groups.

1. Double check that your server name and database numbers are correct for your data. These are displayed below the "Data import" notebook tab.

1. Type a site ID into the site number input box.
1. Select "All" parameter groups from the drop down menu for parameter code group to pull data for all parameters or select a group of parameters.
1. Leave the date range input unchanged to pull the entire period of record or enter a date range in the date range input to pull a subset of the data.
1. Click the "Import Data" button to import the data.
1. Some dialog boxes will open describing what is happening as the program pulls data and generates tables. If one of these boxes remains open for an extended period of time (> 1 minute for most datasets), then an error has occurred. Check your inputs and verify that your database and server number are correct and that your ODBC connection is working with R. 

If you encounter issues with the data import, send an email to tmills@usgs.gov and/or post an issue on the WQReview GitHub page at [WQReview Issues](https://github.com/USGS-R/WQReview/issues)

We can now begin to work with the data.

<img src="manual_dataimport1.png" alt="Drawing" style="width: 400px;"/>

#Importing data for multiple sites and custom parameter codes using a "favorites" list
In addition to pulling data for a single site by parameter group, we can also pull in data for multiple sites using a list of parameters that we are interested in. 

1. Create a list of sites and save it as a .csv file. This is best done in MS Excel. 
1. Create a list of parameter codes and save it as a .csv file. See figure below for example files.

<img src="manual_dataimport2.png" alt="Drawing" style="width: 400px;"/>

1. Close WQReview if open from previous import from above.
1. Open WQReview using the "siteids" and "pcodes" arguments in addition to your server information. The "siteids" and "pcodes" arguments are the path names to your files. For example in CO for the two files shown above we would run the WQReview() function as follows

```R
WQReview(siteids = "pathofdirectory/AllsiteIDs.csv", 
pcodes = "pathofdirectory/Boone_Creek_pcodes.csv",
dlserver.name = "NWISCO", env.db.num = "01", qa.db.num = "02")
```

**NOTE THAT THE FILENAMES ARE IN QUOTES AND THAT THE PATHS ARE CASE SENSITIVE.**

3. Now when WQReview loads, the siteIDs and pcodes will be stored in our favorites lists.
1. To access our favorites list, we will use the radio buttons under the "Site info" and "Parameter info" frames.
1. Click the radio button to the "Favorite site list" and "Favorite pcode" list options and a list of siteIDs and pcodes will appear.
1. These are just lists and none of these sites are selected for import until you click on one. You can select multiple sites and pcodes by using ctrl-click or shift-click.
1. Select your sites and pcodes and click "import data" to import the data.
1. Note: you can edit your favorites inside the GUI by clicking the "Edit favorites" button. To change a value click on the cell and type in the new value, then push the down arrow on your keyboard to store it. To add a new value click the last cell and then push the down arrow on your keyboard to create a new cell. Click "Update Table" when you are finished to update the favorites table. This will update the table in the GUI but WILL NOT save the changes to your .csv file. Thus, it is recommended that all significant changes be made directly to your .csv file using Excel or another text editor.

<img src="manual_dataimport3.png" alt="Drawing" style="width: 400px;"/>

#Importing data for multiple sites and custom parameter codes using a .csv file inputs
The third option for importing data is to use .csv files of siteIDs and pcodes. If you do not wish to pull data for a subset of a larger favorite site list or pcode list then it makes sense to read the input directly from your .csv files. 

1. Start WQReview using the WQReview() function as above, but only the server and database arguments are required for this type of data import.
1. Click the radio button to the third options "SiteIDs from file" and "pcodes from file"
1. A dialog box will appear below the favorites list where we can manually enter the path to your .csv files, or browse to them using the "browse" buttons.
1. Once the field has been populated with the paths to our respective files, we can import the data using the "Import data" button.

###Any combination of the above methods can be used for site inputs and pcode inputs. For example, we can select sites from our favorite list but then pull parameters by parameter code group.
